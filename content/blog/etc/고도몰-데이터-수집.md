---
title: 고도몰 데이터 수집
date: 2020-10-14 18:10:15
category: etc
draft: false
---


// goods/goods_view.html
```javascript
//릴로 수정 시작 
	
	  var nowUrl = window.location.pathname; // 변수에 넣음
	  var userAgent = window.navigator.userAgent; // 브라우저 확인
	  var browser = null;
	  var version = null;


	  if (userAgent.indexOf("Trident/7") > -1) {
		browser = "IE11";
	  } else if (userAgent.indexOf("Trident/6") > -1) {
		browser = "IE10";
	  } else if (userAgent.indexOf("Trident/5") > -1) {
		browser = "IE9";
	  } else if (userAgent.indexOf("Trident/4") > -1) {
		browser = "IE8";
	  } else if (userAgent.indexOf("edge") > -1) {
		browser = "IEEDGE";
	  } else if (userAgent.indexOf("Whale") > -1) {
		// 네이버 WHALE
		browser = "WHALE";
		version = userAgent.split("Whale/")[1].toString().split(" ")[0].toString();
	  } else if (userAgent.indexOf("Opera") > -1 || userAgent.indexOf("OPR") > -1) {
		// 오페라
		if (userAgent.indexOf("Opera") > -1) {
		  browser = "OPERA";
		  version = userAgent
			.split("Opera/")[1]
			.toString()
			.split(" ")[0]
			.toString();
		} else if (userAgent.indexOf("OPR") > -1) {
		  browser = "OPERA";
		  version = userAgent.split("OPR/")[1].toString().split(" ")[0].toString();
		}
	  } else if (userAgent.indexOf("Firefox") > -1) {
		// 파이어폭스
		browser = "FIREFOX";
		version = userAgent
		  .split("Firefox/")[1]
		  .toString()
		  .split(" ")[0]
		  .toString();
	  } else if (
		userAgent.indexOf("Safari") > -1 &&
		userAgent.indexOf("Chrome") == -1
	  ) {
		// 사파리
		browser = "SAFARI";
		version = userAgent.split("Safari/")[1].toString().split(" ")[0].toString();
	  } else if (userAgent.indexOf("SamsungBrowser") > -1) {
		browser = "SAMSUNG";
		version = userAgent
		  .split("SamsungBrowser/")[1]
		  .toString()
		  .split(" ")[0]
		  .toString();
	  } else if (userAgent.indexOf("Chrome") > -1) {
		// 크롬
		browser = "CHROME";
		version = userAgent.split("Chrome/")[1].toString().split(" ")[0].toString();
	  } else {
		browser = "UNKNOWN";
		version = null;
	  }


	  // 브라우저 구분 끝
	
		function getParameterByName(name) {
			name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
			var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
				results = regex.exec(location.search);
			return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
		}
		refererType = getParameterByName('rc');
		console.log(refererType)
		
		// 레퍼럴 체크 
		

	  var device = null;
	  if (
		navigator.userAgent.indexOf("Android") > 0 ||
		navigator.userAgent.indexOf("iPhone") > 0 ||
		navigator.userAgent.indexOf("iPod") > 0 ||
		navigator.userAgent.indexOf("BlackBerry") > 0
	  ) {
		device = "Mobile";
	  } else {
		device = "PC";
	  }

	  // 피씨 모바일 구분 끝

	
	var member = '';
	
	if(($`{=gSess.memId}`)[0].length < 1){
		member = '비회원';
	}else{
		member = '회원';
	}
	
	//console.log(member,(typeof($`{=gSess.memId}`)[0].length) )
	
	// 회원여부 체크 

		

	  var data = [
		{ "refererType": 'rc='+refererType },
		{ "productName": $($`{=goodsView['goodsNmDetail']}`)[0]},
		{ "productPrice": $($`{=gd_isset(goodsView['goodsPrice'],0)}`)[0] },
		{ "member": member },
		{ "memberID": $($`{=gSess.memId}`)[0] },
	    { "접속브라우저":  browser },
	    { "디바이스":  device },

	  ]; // 데이터 

						
		$.getJSON('https://api.ipify.org?format=jsonp&callback=?', function(dataIp) {
			 var ips = JSON.stringify(dataIp.ip).replace(/\"/g,'')
			 ipData = [{"ip": ips}]
			 data = data.concat(ipData); // 데이터에 ip 데이터 추가 삽입
			 sessionStorage.setItem("data", JSON.stringify(data));			  
		}); // ip 데이터 세션 스토리지에 넣음. 
	

	  // 기본 데이터 끝


	  // 장바구니 버튼1 시작
	
	
	  $("#cartBtn").click(function () {
		var cartData = [
			{"cartBtnClick" : 'Y'},
		  //{ name: "장바구니버튼클릭", value: "Y" },
		  //{ name: "장바구니버튼상품", value: product_name },        
		];

		data = data.concat(cartData);
		sessionStorage.setItem("data", JSON.stringify(data));
		console.log(data)
	  }); // 장바구니 버튼 1 끝
	
		  // 관심상품 버튼1 시작
	  $("#btn_add_wish").click(function () {
		var wishData = [
			 {"wishBtnClick" : 'Y'},
		  //{ name: "관심상품버튼클릭", value: "Y" },
		  //{ name: "관심상품버튼상품", value: product_name },        
		];
		data = data.concat(wishData);
		sessionStorage.setItem("data", JSON.stringify(data));
	  }); // 관심상품 버튼 1 끝
	
		  // 장바구니 버튼2 시작
	/*
	  $("#actionCartClone").click(function () {
		var cartData = [
		   {'cartBtnClick':'Y'}
		//  { name: "장바구니버튼클릭", value: "Y" },
		//  { name: "장바구니버튼상품", value: product_name },        
		];

		data = data.concat(cartData);
		sessionStorage.setItem("data", JSON.stringify(data));
	  }); // 장바구니 버튼 2 끝

		  // 관심상품 버튼1 시작
	  $("#actionWish").click(function () {
		var wishData = [
			 {"wishBtnClick" : 'Y'},
		  //{ name: "관심상품버튼클릭", value: "Y" },
		  //{ name: "관심상품버튼상품", value: product_name },        
		];
		data = data.concat(wishData);
		sessionStorage.setItem("data", JSON.stringify(data));
	  }); // 관심상품 버튼 1 끝

		  // 관심상품 버튼2 시작
	  $("#actionWishClone").click(function () {
		var wishData = [
		  {"wishBtnClick" : 'Y'},
		  //{ name: "관심상품버튼클릭", value: "Y" },
		  //{ name: "관심상품버튼상품", value: product_name },        
		];
		data = data.concat(wishData);
		sessionStorage.setItem("data", JSON.stringify(data));
	  }); // 관심상품 버튼 2 끝    



// */
		//릴로 수정 끝
```




// order/order_end.html
```javascript
    var buyData = [
                { 'buy': 'Y' },      
                //{ "buyproductName": $($`{=goodsView['goodsNmDetail']}`)[0]},
                //{ "buyproductPrice": $($`{=gd_isset(goodsView['goodsPrice'],0)}`)[0] },
            ];
            var data =  JSON.parse(sessionStorage.getItem('data'));			
                data = data.concat(buyData);
                console.log(data)
                sessionStorage.setItem("data", JSON.stringify(data));
```
